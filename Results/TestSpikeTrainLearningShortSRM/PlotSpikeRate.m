
%% load data
clear all
clc

load('TestSpikeRate.mat')

C1 = zeros(50,2);
C2 = zeros(50,2);
C3 = zeros(50,2);
C4 = zeros(50,2);
for i = 1:50
    [C1(i,1),C1(i,2)] = max(OfflineStaticDelaySpikeRate100(i,:));
    [C2(i,1),C2(i,2)] = max(OfflineDynamicDelaySpikeRate100(i,:));
    [C3(i,1),C3(i,2)] = max(OnlineStaticDelaySpikeRate100(i,:));
    [C4(i,1),C4(i,2)] = max(OnlineDynamicDelaySpikeRate100(i,:));
end

%% avg
m1 = mean(C1);
m2 = mean(C2);
m3 = mean(C3);
m4 = mean(C4);

s1 = std(C1);
s2 = std(C2);
s3 = std(C3);
s4 = std(C4);
%% data
clear all

C=[0.957544027969865,0.951196899562511,0.829208598815813,0.743527108232236,0.752558554237290,0.743882548541249,0.762179642442826,0.756112218129828,0.761577376537860,0.762982529177272
0.980204327743240,0.933087723628366,0.736621035714939,0.705450641855224,0.653596980175969,0.660399440602674,0.712911820751717,0.740718994634456,0.759732041518450,0.759817306972361
0.976702971069992,0.953239085381723,0.924583232501027,0.916167354579459,0.936744517401143,0.935649322173446,0.946504322827366,0.939212968982393,0.951094130032298,0.959387012086416
0.982759505926753,0.977740768444879,0.965614778090449,0.946968039000712,0.961576795256422,0.955626264656228,0.962144150342451,0.947553630400926,0.947999312673661,0.950230011056438];

Epoch=[85.440000000000000,78.160000000000000,47.340000000000000,19.840000000000000,20.080000000000000,16.800000000000000,6.880000000000000,3.460000000000000,3.240000000000000,2.680000000000000
79.020000000000000,66.120000000000000,13.120000000000000,6,3.520000000000000,2.580000000000000,1.980000000000000,2.820000000000000,2.540000000000000,2.160000000000000
39.880000000000000,21.840000000000000,17.340000000000000,7.200000000000000,3.800000000000000,2.880000000000000,3.400000000000000,2.240000000000000,2.040000000000000,2.020000000000000
62.480000000000000,53.300000000000000,25.860000000000000,9,5.980000000000000,6.900000000000000,3.440000000000000,3.400000000000000,2.680000000000000,2.580000000000000];

Cstd=[0.067372441599981,0.072925471487860,0.085935034269155,0.096722636669915,0.073114663716557,0.072873310101144,0.054835817451774,0.053937415150349,0.040983318501991,0.046449775576517
0.032288416482245,0.091203520254805,0.069165418072583,0.070655201850624,0.062859427869150,0.067339223762989,0.052128169660931,0.055420369382149,0.044689171776883,0.048009752817630
0.040317731056362,0.046704287592950,0.044561911152540,0.086186286853380,0.023676380840237,0.059155761018450,0.021219152646412,0.064669363455250,0.049057793880627,0.035532646508107
0.036529923844033,0.031230193535275,0.026431889698917,0.079160415558041,0.019964747459105,0.068893833987666,0.028632859259610,0.078189239393119,0.074202560528120,0.061950429972884];

Epochstd=[11.303169142017703,14.044186828487772,25.553952527856005,14.637608815538648,23.666768228200212,20.484937223756017,8.394945029052685,1.053855893800456,1.378552923635980,1.236189008730511
12.889625633803020,25.093815808615770,7.272088098072138,1.678191446352962,1.487910464719033,1.458122919708620,0.868731188314901,1.206952647736253,0.930437685024787,0.997138763806580
26.985740754732536,21.787807861934425,20.552183458162283,10.569497893196521,3.597050946289763,1.533836060739377,6.101187572589322,0.770899289327546,0.402035636556294,0.318798765777449
17.813363477101877,24.666965433013228,22.024114798399080,10.528871870107588,3.862377400471565,13.127708661220266,1.896936305451181,1.862629258629328,1.284761551766693,0.970798114744686];

%% plot C
x = 1:10;

figure('position', [800,400,400,200]);
errorbar(x, C(1,:), Cstd(1,:), '+--r','lineWidth', 1)
hold on;
errorbar(x, C(2,:), Cstd(2,:), 'x--b','lineWidth', 1)
hold on;
errorbar(x, C(3,:), Cstd(3,:), 'o-r','lineWidth', 1)
hold on;
errorbar(x, C(4,:), Cstd(4,:), 's-b','lineWidth', 1)
hold on;

axis([0.5, 10.5, 0.5, 1.04]);%xmin xmax ymin ymax
set(gca,'XTick',[1,2,3,4,5,6,7,8,9,10],'Fontsize',10,'FontName','Times New Roman');
set(gca,'XTickLabel', {'10','20','30','40','50','60','70','80','90','100'},'FontSize',10,'FontName','Times New Roman');

xlabel('Spike Firing Rate (Hz)','Fontsize',12,'FontName','Times New Roman');
ylabel('\it C','Fontsize',12,'FontName','Times New Roman');

legend({'Off-SD','Off-DD','On-SD','On-DD'},'location','best','Fontsize',10);
title('(a)','fontname','Times New Roman','fontsize',12);
hold off;
%% plot epoch

figure('position', [800,400,400,200]);
bar(Epoch');
hold on

numgroups = size(Epoch, 2); 
numbars = size(Epoch, 1); 
groupwidth = min(0.8, numbars/(numbars+1.5));
for i = 1:numbars
      % Based on barweb.m by Bolu Ajiboye from MATLAB File Exchange
      x = (1:numgroups) - groupwidth/2 + (2*i-1) * groupwidth / (2*numbars);  % Aligning error bar with individual bar
      errorbar(x, Epoch(i,:), Epochstd(i,:), 'k', 'linestyle', 'none', 'lineWidth', 1);
end

axis([0.5, 10.5, 0, 105]);%xmin xmax ymin ymax
set(gca,'XTick',[1,2,3,4,5,6,7,8,9,10],'Fontsize',10,'FontName','Times New Roman');
set(gca,'XTickLabel', {'10','20','30','40','50','60','70','80','90','100'},'FontSize',10,'FontName','Times New Roman');

xlabel('Spike Firing Rate (Hz)','Fontsize',12,'FontName','Times New Roman');
ylabel('Learning Epochs','Fontsize',12,'FontName','Times New Roman');

legend({'Off-SD','Off-DD','On-SD','On-DD'},'location','best','Fontsize',10);
title('(b)','fontname','Times New Roman','fontsize',12);

hold off;